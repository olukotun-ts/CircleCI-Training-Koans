version: 2.1

# setup: true

orbs:
  continuation: circleci/continuation@0.2.0

workflows:
  setup:
    jobs:
      - get_config
    
jobs:
  get_config:
    executor: continuation/default
    steps:
      - checkout
      - run: |
          CHANGE_DIR=$(git diff --name-only HEAD~1 | awk -F "/*[^/]*/*$" '{ print ($1 == "" ? "." : $1); }' | sort | uniq)
          echo CHANGE_DIR: $CHANGE_DIR
          echo $CHANGE_DIR >> BASH_ENV
      - run: |
          echo CHANGE_DIR: $CHANGE_DIR 