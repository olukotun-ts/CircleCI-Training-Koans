version: 2.1

orbs:
  win: circleci/windows@2.2.0

#Reusable Commands across all jobs
commands:
  git--checkout:
    steps:
      - add_ssh_keys:
          fingerprints:
            - "30:7d:2d:e4:24:a4:15:c8:8f:29:b3:23:33:d6:4b:58"
      - run: ssh-keyscan -H github.com >> ~/.ssh/known_hosts
      - run:
          name: git-checkout
          command: |
            git clone --depth 5 "$CIRCLE_REPOSITORY_URL" --branch "$CIRCLE_BRANCH"
            cd "$CIRCLE_PROJECT_REPONAME"

jobs:
  build-osx:
    macos: 
      xcode: 12.1.0
    steps:
      - git--checkout
  
  build-win:
    executor: win/default
      size: "medium"
      shell: bash.exe
    steps:
      - git--checkout

workflows:
  main_flow:
    jobs:
      - build-osx
      - build-win
